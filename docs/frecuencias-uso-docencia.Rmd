---
title: "uso-chatbots-docentes"
author: "JJ Merelo"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE, echo=FALSE}
library(ggplot2)
library(dplyr)
library(tidyr)

frecuencias_data <- read.csv("../data/frecuencias-uso-docentes.csv", header = TRUE, na.strings="", sep = ";")

columnas <- strsplit("administrativas;burocracia;calendario;comunicacion-profesorado;feedback;generar-material;preguntas-temario;preparar-examen;profesor-particular;resumen;traduccion", ";")

resultados_uso <- data.frame( uso=character(),
                              frecuencia=character(),
                              respuestas=numeric(),
                              porcentaje = numeric() );

for ( i in columnas[[1]] ) {
  i <- gsub("-", ".", i)

  porcentajes_data <-  frecuencias_data[i] %>% drop_na() %>% group_by(.data[[i]]) %>%
  summarise(Número = n()) %>%
  mutate(Proporción = Número / sum(Número))

  porcentajes_data$Frecuencia <- factor(porcentajes_data[[i]],
                                        levels = c("No me parece útil", "Me gustaría hacerlo", "Lo he hecho"))

  for (j in levels(porcentajes_data$Frecuencia) ) {
    resultados_uso <- rbind( resultados_uso,
                             data.frame( uso = i,
                                         frecuencia = j,
                                         respuestas = sum( porcentajes_data$Número[porcentajes_data$Frecuencia == j] ),
                                         porcentaje = sum( porcentajes_data$Proporción[porcentajes_data$Frecuencia == j] )
                             )
    )
  }

}

```

## Uso de chatbots por parte de los docentes

En la encuesta se preguntó a los docentes sobre el uso que hacían de chatbots para diferentes tareas relacionadas con la docencia; las preguntas son equivalentes a las respondidas por los estudiantes pero reducidas al ámbito de docencia. Hubo `r length(frecuencias_data$Disciplina)` respuestas, de las cuales `r length(frecuencias_data[ frecuencias_data$Disciplina == "TIC",]$Disciplina)` eran de docentes TIC. Un análisis chi cuadrado de las diferencias entre docentes TICs y otros no arrojó diferencias significativas, por lo que se decidió analizar en conjunto todas las respuestas.

```{r grafico, echo=FALSE, message=FALSE, warning=FALSE}
resultados_uso$uso <- factor(resultados_uso$uso,
                             levels = resultados_uso %>%
                               filter(frecuencia == "Lo he hecho") %>%
                               arrange(porcentaje) %>% pull(uso)
                             )
translated_labels <- c("Interaction w/ students",
                               "Calendar",
                               "Administration",
                               "Bureaucracy",
                               "Help with feedback",
                               "Private tutor",
                               "Summarizing texts",
                       "Answer syllabus questions",
                               "Generate material",
                               "Preparing exams",
                               "Translate texts")  
ggplot(resultados_uso, aes(x=uso, fill=frecuencia, y = porcentaje)) +
  geom_bar( stat="identity", position="dodge") +
  labs(title="Teacher's use of chatbots", x="Application", y="Proportion") +
  scale_x_discrete( labels = translated_labels ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 60, hjust = 1))
```

En la figura están organizados por valor creciente de la respuesta "Lo ha hecho"; se ve un uso más intenso cuando se trata de trabajar con texto, más que en temas relacionados con interacción. Lo vemos también en la siguiente tabla

```{r tabla, echo=FALSE, echo=FALSE, message=FALSE, warning=FALSE}
library(knitr)
library(kableExtra)
resultados_uso$porcentaje <- NULL
resultados_uso %>%
  pivot_wider(names_from = frecuencia, values_from = respuestas) %>%
  arrange(desc(`Lo he hecho`)) %>%
  kable( digits=3,
         col.names = c("Application", "It's not useful", "I'd like to do it", "I've done it"),
         caption = "How often I have used chatbots for this purpose",
  ) %>%
  kable_styling( full_width = FALSE )
```
