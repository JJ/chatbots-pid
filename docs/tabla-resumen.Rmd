---
title: "uso-chatbots-docentes"
author: "JJ Merelo"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, message=F,echo=FALSE}
library(ggplot2)
library(dplyr)

estudiantes_piloto <- read.csv("../data-raw/estudiantes-piloto.csv", header = TRUE, na.strings="", sep = ";") %>% filter( X.Cuál.es.su.perfil. != "Docente" )
estudiantes_final <- read.csv("../data-raw/encuesta.csv", header = TRUE, na.strings="", sep = ";") %>% filter( X.Cuál.es.su.perfil. != "Docente" )
docentes_piloto <- read.csv("../data-raw/respuestas-docentes-piloto.csv", header = TRUE, na.strings="", sep = ";") %>% filter( X.Cuál.es.su.perfil. == "Docente" )

docentes_final <- read.csv("../data-raw/respuestas-docentes.csv", header = TRUE, na.strings="", sep = ";") %>% filter( !is.na(X.Qué.medios.de.comunicación.usa.en.el.contexto.universitario.) )

table_data <- data.frame( survey=c(rep("Pilot", nrow(estudiantes_piloto)),
                                         rep("Final", nrow(estudiantes_final)),
                                         rep("Pilot", nrow(docentes_piloto)),
                                         rep("Final", nrow(docentes_final))),
                                profile=c(rep("Student", nrow(estudiantes_piloto)+nrow(estudiantes_final)),
                                          rep("Teacher", nrow(docentes_piloto)+nrow(docentes_final))),
                                disciplina=c(estudiantes_piloto$X.Cuál.es.su.campo.de.estudio.área.de.trabajo.,
                                              estudiantes_final$X.Cuál.es.su.campo.de.estudio.área.de.trabajo.,
                                              docentes_piloto$X.Cuál.es.su.campo.de.estudio.área.de.trabajo.,
                                              docentes_final$X.Cuál.es.su.campo.de.estudio.área.de.trabajo.),
                                genero=c(estudiantes_piloto$X.Con.qué.género.se.identifica.,
                                         estudiantes_final$X.Con.qué.género.se.identifica.,
                                         docentes_piloto$X.Con.qué.género.se.identifica.,
                                         docentes_final$X.Con.qué.género.se.identifica.)
                               )


table_data$Study_Area <- ifelse(grepl("Ingenierías|Computación|Informática", table_data$disciplina),"IT",
                                      ifelse(grepl("Traducción|Filología", table_data$disciplina), "Language studies", "Other" ))

table_data$Gender <- ifelse(table_data$genero == "Prefiero no decirlo", "Prefer not to say", ifelse(table_data$genero == "Masculino", "Male", "Female"))


table_data %>% group_by(profile, Study_Area,Gender) %>% summarise( n=n()) %>% mutate( proportion = n / sum(n) ) -> summary_data
summary_data$percentage <- summary_data$proportion * 100
summary_data$proportion <- NULL

library(knitr)
library(kableExtra)

summary_data %>% kable(digits=2, col.names = c("Profile","Study Area","Gender","Number","%")) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
```
